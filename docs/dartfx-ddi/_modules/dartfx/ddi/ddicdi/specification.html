

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dartfx.ddi.ddicdi.specification &mdash; Data Artifex DDI Toolkit 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css?v=96a89a29" />

  
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=01f34227"></script>
      <script src="../../../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            Data Artifex DDI Toolkit
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../installation.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../installation.html#installation-from-pypi">Installation from PyPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../installation.html#development-installation">Development Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../installation.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../installation.html#development-dependencies">Development Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../installation.html#verification">Verification</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quickstart.html">Quick Start Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../quickstart.html#ddi-codebook">DDI-Codebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../quickstart.html#ddi-cdi-assistant-framework">DDI-CDI &amp; Assistant Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../quickstart.html#conversion-from-ddi-codebook">Conversion from DDI-Codebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../quickstart.html#specification-loader">Specification Loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../quickstart.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples.html#ddi-codebook-examples">DDI-Codebook Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples.html#basic-metadata-extraction">Basic Metadata Extraction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples.html#ddi-cdi-assistant-framework">DDI-CDI Assistant Framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples.html#creating-a-dataset-with-variables">Creating a DataSet with Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples.html#serialization-to-rdf">Serialization to RDF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples.html#automated-identification">Automated Identification</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples.html#direct-model-usage">Direct Model Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples.html#ddi-codebook-to-ddi-cdi-mapping">DDI-Codebook to DDI-CDI Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples.html#specification-loader">Specification Loader</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html">DDI-Codebook to DDI-CDI CDIF Mappings</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#general-approach">General Approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#variable-level-mappings">Variable-Level Mappings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#ddi-codebook-variable-ddi-cdi-instancevariable">DDI-Codebook Variable → DDI-CDI InstanceVariable</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#value-domain-mappings">Value Domain Mappings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#substantive-value-domain-non-missing-categories">Substantive Value Domain (Non-Missing Categories)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#standard-mode-use-skos-false">Standard Mode (use_skos=False)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#skos-mode-use-skos-true">SKOS Mode (use_skos=True)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#sentinel-value-domain-missing-categories">Sentinel Value Domain (Missing Categories)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#id1">Standard Mode (use_skos=False)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#id2">SKOS Mode (use_skos=True)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#category-and-code-mappings">Category and Code Mappings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#id3">Standard Mode (use_skos=False)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#id4">SKOS Mode (use_skos=True)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#dataset-and-structure-mappings">Dataset and Structure Mappings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#ddi-codebook-filedscr-ddi-cdi-dataset">DDI-Codebook fileDscr → DDI-CDI DataSet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#ddi-codebook-filedscr-ddi-cdi-logicalrecord">DDI-Codebook fileDscr → DDI-CDI LogicalRecord</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#ddi-codebook-ddi-cdi-datastructure">DDI-Codebook → DDI-CDI DataStructure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#variable-positioning-in-datastructure">Variable Positioning in DataStructure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#resource-organization">Resource Organization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#identifier-strategy">Identifier Strategy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#uuid-generation">UUID Generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#id-suffix-patterns">ID Suffix Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#non-ddi-identifiers">Non-DDI Identifiers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#important-assumptions">Important Assumptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#processing-order">Processing Order</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#skos-vs-standard-mode-comparison">SKOS vs Standard Mode Comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#method-signature">Method Signature</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#parameters">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#usage-example">Usage Example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#basic-conversion">Basic Conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#standard-mode-conversion">Standard Mode Conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#converting-to-rdf-graph">Converting to RDF Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#exploring-resources">Exploring Resources</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#related-functions">Related Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#codebook-to-cdif-graph">codebook_to_cdif_graph()</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#ddi-cdi-resources-to-graph">ddi_cdi_resources_to_graph()</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#version-information">Version Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../codebook_to_cdi_mappings.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../ddicodebook.html">DDI-Codebook Processing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../ddicodebook.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ddicodebook.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ddicodebook.html#accessing-study-metadata">Accessing Study Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ddicodebook.html#working-with-variables">Working with Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ddicodebook.html#working-with-files">Working with Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ddicodebook.html#error-handling">Error Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ddicodebook.html#implementation-notes">Implementation Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ddicodebook.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ddicodebook.html#module-dartfx.ddi.ddicodebook">API Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ddicdi.html">DDI Cross Domain Integration (CDI)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../ddicdi.html#architecture">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ddicdi.html#key-features">Key Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ddicdi.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ddicdi.html#working-with-associations">Working with Associations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ddicdi.html#mapping-from-ddi-codebook">Mapping from DDI-Codebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ddicdi.html#deprecated-modules">Deprecated Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ddicdi.html#api-reference-notes">API Reference Notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../specification.html">DDI-CDI Specification Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../specification.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../specification.html#key-features">Key Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../specification.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../specification.html#api-reference">API Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../specification.html#ddicdimodel">DdiCdiModel</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../specification.html#dartfx.ddi.ddicdi.specification.DdiCdiModel"><code class="docutils literal notranslate"><span class="pre">DdiCdiModel</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../rdf_integration.html">RDF Integration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../rdf_integration.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../rdf_integration.html#the-definitive-model-v1-0-0">The Definitive Model (v1.0.0)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../rdf_integration.html#direct-model-usage">Direct Model Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../rdf_integration.html#shacl-validation">SHACL Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../rdf_integration.html#legacy-sempyro">Legacy: SemPyRO</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../contributing.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../contributing.html#development-setup">Development Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../contributing.html#running-tests">Running Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../contributing.html#code-style">Code Style</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../contributing.html#documentation">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../contributing.html#submitting-changes">Submitting Changes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../contributing.html#types-of-contributions">Types of Contributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../contributing.html#guidelines">Guidelines</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../changelog.html#version-0-1-0-current">Version 0.1.0 (Current)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../changelog.html#refactors">Refactors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../changelog.html#features">Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../changelog.html#known-issues">Known Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../changelog.html#upcoming-features">Upcoming Features</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../changelog.html#previous-versions">Previous Versions</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Data Artifex DDI Toolkit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">dartfx.ddi.ddicdi.specification</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for dartfx.ddi.ddicdi.specification</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">ddicdi_model.py</span>

<span class="sd">This module defines the DdiCdiModel class, which provides an interface for loading, querying,</span>
<span class="sd">and interacting with DDI-CDI specification using rdflib and Pydantic.</span>

<span class="sd">It supports loading Turtle files, querying RDF graphs with SPARQL, and retrieving model</span>
<span class="sd">metadata, classes, attributes, associations, enumerations, and structured datatypes.</span>
<span class="sd">The XML schema version is also loaded for retrieving resource multiplicty / acardinalities</span>
<span class="sd">which are not capture in the ontology.</span>

<span class="sd">The class provides utility methods for working with namespaces and prefixed URIs.</span>

<span class="sd">Examples:</span>

<span class="sd">Load the model:</span>
<span class="sd">```python</span>
<span class="sd">from dartfx.ddi.ddicdi_model import DdiCdiModel</span>
<span class="sd">model = DdiCdiModel(root_dir=&quot;/path/to/ddi-cdi&quot;)</span>
<span class="sd">```</span>

<span class="sd">Get all ucmis resources:</span>
<span class="sd">```python</span>
<span class="sd">classes = model.get_ucmis_classes()</span>
<span class="sd">associations = model.get_ucmis_associations()</span>
<span class="sd">attributes = model.get_ucmis_attributes()</span>
<span class="sd">enums = model.get_ucmis_enumerations()</span>
<span class="sd">data_types = model.get_ucmis_structureddatatypes()</span>
<span class="sd">```</span>

<span class="sd">Get resource information:</span>
<span class="sd">```python</span>
<span class="sd">superclasses = model.get_resource_superclasses(&quot;cdi:InstanceVariable&quot;)</span>
<span class="sd">subclasses = model.get_resource_subclasses(&quot;cdi:InstanceVariable&quot;)</span>
<span class="sd">attributes = model.get_resource_attributes(&quot;cdi:InstanceVariable&quot;, inherited=True)</span>
<span class="sd">associations = model.get_resource_associations(&quot;cdi:InstanceVariable&quot;)</span>
<span class="sd">```</span>

<span class="sd">SPDX-Identifier: MIT</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xml.etree.ElementTree</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ET</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">computed_field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdflib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Graph</span><span class="p">,</span> <span class="n">Namespace</span>

<span class="n">NAMESPACES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;rdf&quot;</span><span class="p">:</span> <span class="s2">&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rdfs&quot;</span><span class="p">:</span> <span class="s2">&quot;http://www.w3.org/2000/01/rdf-schema#&quot;</span><span class="p">,</span>
    <span class="s2">&quot;owl&quot;</span><span class="p">:</span> <span class="s2">&quot;http://www.w3.org/2002/07/owl#&quot;</span><span class="p">,</span>
    <span class="s2">&quot;xsd&quot;</span><span class="p">:</span> <span class="s2">&quot;http://www.w3.org/2001/XMLSchema#&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dc&quot;</span><span class="p">:</span> <span class="s2">&quot;http://purl.org/dc/elements/1.1/&quot;</span><span class="p">,</span>
    <span class="s2">&quot;skos&quot;</span><span class="p">:</span> <span class="s2">&quot;http://www.w3.org/2004/02/skos/core#&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cdi&quot;</span><span class="p">:</span> <span class="s2">&quot;http://ddialliance.org/Specification/DDI-CDI/1.0/RDF/&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ucmis&quot;</span><span class="p">:</span> <span class="s2">&quot;tag:ddialliance.org,2024:ucmis:&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">REVERSE_NAMESPACES</span> <span class="o">=</span> <span class="p">{</span><span class="n">uri</span><span class="p">:</span> <span class="n">prefix</span> <span class="k">for</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">uri</span> <span class="ow">in</span> <span class="n">NAMESPACES</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

<span class="n">XMLNS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;xs&quot;</span><span class="p">:</span> <span class="s2">&quot;http://www.w3.org/2001/XMLSchema&quot;</span><span class="p">,</span> <span class="s2">&quot;xml&quot;</span><span class="p">:</span> <span class="s2">&quot;http://www.w3.org/XML/1998/namespace&quot;</span><span class="p">}</span>


<div class="viewcode-block" id="DdiCdiModel">
<a class="viewcode-back" href="../../../../specification.html#dartfx.ddi.ddicdi.specification.DdiCdiModel">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DdiCdiModel</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to represent the DDI CDI model</span>

<span class="sd">    this is implemented as a wrapper around the DDI-CDI specification official</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">root_dir</span><span class="p">:</span> <span class="nb">str</span>

    <span class="n">_graph</span><span class="p">:</span> <span class="n">Graph</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_xml</span><span class="p">:</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="s2">&quot;root&quot;</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Root directory does not exist: </span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;root&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">model_post_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">__context</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pydantic post-init method to load Turtle and XML files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_ontology</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ontology_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xml</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_xml</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xmlschema_dir</span><span class="p">,</span> <span class="s2">&quot;ddi-cdi.xsd&quot;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">uri</span> <span class="ow">in</span> <span class="n">NAMESPACES</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">Namespace</span><span class="p">(</span><span class="n">uri</span><span class="p">))</span>

    <span class="nd">@computed_field</span>  <span class="c1"># type: ignore</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">build_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the directory path where the model build artifacts are located.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span><span class="p">,</span> <span class="s2">&quot;build&quot;</span><span class="p">)</span>

    <span class="nd">@computed_field</span>  <span class="c1"># type: ignore</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">encoding_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the directory path where the model encoding are located.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">build_dir</span><span class="p">,</span> <span class="s2">&quot;encoding&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graph</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the in-memory RDF graph containing the loaded Turtle files.</span>
<span class="sd">        This graph can be queried using SPARQL.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Graph has not been initialized. Call model_post_init first.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span>

    <span class="nd">@computed_field</span>  <span class="c1"># type: ignore</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">jsonld_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the directory path where the JSON-LD files are located.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding_dir</span><span class="p">,</span> <span class="s2">&quot;jsonld&quot;</span><span class="p">)</span>

    <span class="nd">@computed_field</span>  <span class="c1"># type: ignore</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ontology_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the directory path where the ontology files are located.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding_dir</span><span class="p">,</span> <span class="s2">&quot;ontology&quot;</span><span class="p">)</span>

    <span class="nd">@computed_field</span>  <span class="c1"># type: ignore</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">source_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the directory path where the source files are located.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">xml</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the root element of the loaded XML schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xml</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XML has not been initialized. Call model_post_init first.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xml</span>

    <span class="nd">@computed_field</span>  <span class="c1"># type: ignore</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">xmlschema_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the directory path where the XML Schema files are located.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding_dir</span><span class="p">,</span> <span class="s2">&quot;xml-schema&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_ontology</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory_path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graph</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads all Turtle (.ttl) files from the specified directory into an in-memory RDF graph.</span>
<span class="sd">        Returns the rdflib.Graph object, which can be queried with SPARQL.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory_path</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.ttl&quot;</span><span class="p">):</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory_path</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
                <span class="n">g</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;turtle&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">g</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads an XML file and returns its root element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XML file not found: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tree</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_association_cardinalities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">association_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the from and to cardinalities of an association for a given association URI.</span>
<span class="sd">        Uses the XML schema to determine the minOccurs and maxOccurs values and other attributes.</span>

<span class="sd">        The complexType name and element @id are extracted from the association URI,</span>
<span class="sd">        and the XPath is constructed to find the corresponding element in the XML schema.</span>

<span class="sd">        Returns a dictionary with the two cardinalities: &#39;to&#39; and &#39;from&#39;</span>

<span class="sd">        Example:</span>
<span class="sd">        {</span>
<span class="sd">            &quot;from&quot;: {</span>
<span class="sd">                &quot;minOccurs&quot;: &quot;0&quot;,</span>
<span class="sd">                &quot;maxOccurs&quot;: &quot;unbounded&quot;,</span>
<span class="sd">                &quot;display&quot;: &quot;0..*&quot;</span>
<span class="sd">                &quot;type&quot;: &quot;InstanceVariable&quot;</span>
<span class="sd">            },</span>
<span class="sd">            &quot;to&quot;: {</span>
<span class="sd">                &quot;minOccurs&quot;: &quot;0&quot;,</span>
<span class="sd">                &quot;maxOccurs&quot;: &quot;unbounded&quot;,</span>
<span class="sd">                &quot;display&quot;: &quot;0..*&quot;,</span>
<span class="sd">                &quot;types&quot;: [</span>
<span class="sd">                &quot;PhysicalSegmentLayout&quot;,</span>
<span class="sd">                &quot;UnitSegmentLayout&quot;</span>
<span class="sd">                ]</span>
<span class="sd">            }</span>
<span class="sd">        }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cardinalities</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">association_name</span> <span class="o">=</span> <span class="n">association_uri</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">association_components</span> <span class="o">=</span> <span class="n">association_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
        <span class="n">association_from</span> <span class="o">=</span> <span class="n">association_components</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># association_type = association_components[1]</span>
        <span class="c1"># association_to = association_components[2]</span>
        <span class="c1"># ./xs:complexType[@id=&#39;InstanceVariableXsdType&#39;]//xs:element[@id=&#39;InstanceVariable_has_PhysicalSegmentLayout&#39;]</span>
        <span class="n">xpath</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;./</span><span class="se">{{</span><span class="si">{</span><span class="n">XMLNS</span><span class="p">[</span><span class="s1">&#39;xs&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span><span class="s2">complexType[@</span><span class="se">{{</span><span class="si">{</span><span class="n">XMLNS</span><span class="p">[</span><span class="s1">&#39;xml&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span><span class="s2">id=&#39;</span><span class="si">{</span><span class="n">association_from</span><span class="si">}</span><span class="s2">XsdType&#39;]//</span><span class="se">{{</span><span class="si">{</span><span class="n">XMLNS</span><span class="p">[</span><span class="s1">&#39;xs&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span><span class="s2">element[@</span><span class="se">{{</span><span class="si">{</span><span class="n">XMLNS</span><span class="p">[</span><span class="s1">&#39;xml&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span><span class="s2">id=&#39;</span><span class="si">{</span><span class="n">association_name</span><span class="si">}</span><span class="s2">&#39;]&quot;</span>
        <span class="n">from_element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">xpath</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">from_element</span><span class="p">:</span>
            <span class="c1"># FROM</span>
            <span class="n">cardinality_from</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">cardinality_from</span><span class="p">[</span><span class="s2">&quot;minOccurs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">from_element</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;minOccurs&quot;</span><span class="p">)</span>
            <span class="n">cardinality_from</span><span class="p">[</span><span class="s2">&quot;maxOccurs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">from_element</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;maxOccurs&quot;</span><span class="p">)</span>
            <span class="c1"># Convert to a string representation</span>
            <span class="n">cardinality_from</span><span class="p">[</span><span class="s2">&quot;display&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cardinality_from</span><span class="p">[</span><span class="s1">&#39;minOccurs&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">..</span><span class="si">{</span><span class="n">cardinality_from</span><span class="p">[</span><span class="s1">&#39;maxOccurs&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="n">cardinality_from</span><span class="p">[</span><span class="s2">&quot;maxOccurs&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;unbounded&quot;</span>
                <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cardinality_from</span><span class="p">[</span><span class="s1">&#39;minOccurs&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">..*&quot;</span>
            <span class="p">)</span>
            <span class="n">cardinality_from</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">association_from</span>
            <span class="n">cardinalities</span><span class="p">[</span><span class="s2">&quot;from&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cardinality_from</span>
            <span class="c1"># TO .//xs:element[@id=&#39;InstanceVariable_has_PhysicalSegmentLayout-validType&#39;]</span>
            <span class="n">xpath</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;.//</span><span class="se">{{</span><span class="si">{</span><span class="n">XMLNS</span><span class="p">[</span><span class="s1">&#39;xs&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span><span class="s2">element[@</span><span class="se">{{</span><span class="si">{</span><span class="n">XMLNS</span><span class="p">[</span><span class="s1">&#39;xml&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span><span class="s2">id=&#39;</span><span class="si">{</span><span class="n">association_name</span><span class="si">}</span><span class="s2">-validType&#39;]&quot;</span>
            <span class="n">to_element</span> <span class="o">=</span> <span class="n">from_element</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">xpath</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">to_element</span><span class="p">:</span>
                <span class="n">cardinality_to</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">cardinality_to</span><span class="p">[</span><span class="s2">&quot;minOccurs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_element</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;minOccurs&quot;</span><span class="p">)</span>
                <span class="n">cardinality_to</span><span class="p">[</span><span class="s2">&quot;maxOccurs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_element</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;maxOccurs&quot;</span><span class="p">)</span>
                <span class="c1"># Convert to a string representation</span>
                <span class="n">cardinality_to</span><span class="p">[</span><span class="s2">&quot;display&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cardinality_to</span><span class="p">[</span><span class="s1">&#39;minOccurs&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">..</span><span class="si">{</span><span class="n">cardinality_to</span><span class="p">[</span><span class="s1">&#39;maxOccurs&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="k">if</span> <span class="n">cardinality_to</span><span class="p">[</span><span class="s2">&quot;maxOccurs&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;unbounded&quot;</span>
                    <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cardinality_to</span><span class="p">[</span><span class="s1">&#39;minOccurs&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">..*&quot;</span>
                <span class="p">)</span>
                <span class="c1"># add types</span>
                <span class="n">xpath</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;.//</span><span class="se">{{</span><span class="si">{</span><span class="n">XMLNS</span><span class="p">[</span><span class="s1">&#39;xs&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span><span class="s2">enumeration&quot;</span>
                <span class="n">to_types_elements</span> <span class="o">=</span> <span class="n">to_element</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">xpath</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">to_types_elements</span><span class="p">:</span>
                    <span class="n">cardinality_to</span><span class="p">[</span><span class="s2">&quot;types&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">to_types_elements</span><span class="p">]</span>
                <span class="n">cardinalities</span><span class="p">[</span><span class="s2">&quot;to&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cardinality_to</span>
        <span class="k">return</span> <span class="n">cardinalities</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_class_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_uri</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Counts the number of instances of a specific class in the RDF graph.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT (COUNT(?instance) AS ?count)</span>
<span class="s2">        WHERE </span><span class="se">{{</span>
<span class="s2">            ?instance a </span><span class="si">{</span><span class="n">class_uri</span><span class="si">}</span><span class="s2"> .</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="n">count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">results</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># type: ignore</span>
        <span class="k">return</span> <span class="n">count</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves all classes in the RDF graph.</span>
<span class="sd">        Returns a list of class URIs (as prefixed URIs if possible).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            SELECT DISTINCT ?c</span>
<span class="s2">                WHERE {</span>
<span class="s2">                    {[] a ?c .}</span>
<span class="s2">                }</span>
<span class="s2">            order by ?c        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>  <span class="c1"># type: ignore</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_enumeration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enumeration_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves information about an enumeration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">enumeration</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_properties</span><span class="p">(</span><span class="n">enumeration_uri</span><span class="p">)</span>
        <span class="n">enumeration</span><span class="p">[</span><span class="s2">&quot;uri&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enumeration_uri</span>
        <span class="n">enumeration</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rdfs:label&quot;</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">enumeration</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rdfs:comment&quot;</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="c1"># get members</span>
        <span class="n">members</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            SELECT ?s</span>
<span class="s2">            WHERE </span><span class="se">{{</span>
<span class="s2">                ?s a </span><span class="si">{</span><span class="n">enumeration_uri</span><span class="si">}</span><span class="s2"> ;</span>
<span class="s2">            </span><span class="se">}}</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="n">member_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># type: ignore</span>
            <span class="n">member_properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_properties</span><span class="p">(</span><span class="n">member_uri</span><span class="p">)</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">member_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rdfs:label&quot;</span><span class="p">)</span>
            <span class="n">description</span> <span class="o">=</span> <span class="n">member_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rdfs:comment&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">description</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>  <span class="c1"># NOTE: this is to accommodate for extra lines in enumeration&#39;s comments</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
                <span class="n">description</span> <span class="o">=</span> <span class="n">description</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">members</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="n">member_uri</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">label</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">}</span>
        <span class="n">enumeration</span><span class="p">[</span><span class="s2">&quot;members&quot;</span><span class="p">]:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">members</span>  <span class="c1"># type: ignore</span>
        <span class="k">return</span> <span class="n">enumeration</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_resource_attribute_cardinality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_resource_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">attribute_uri</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the cardinality of attribute for a given resource URI.</span>
<span class="sd">        Uses the XML schema to determine the minOccurs and maxOccurs values.</span>

<span class="sd">        The complexType name and element @id are extracted from the resource URI,</span>
<span class="sd">        and the XPath is constructed to find the corresponding element in the XML schema.</span>

<span class="sd">        XPath example for InstanceVariable-physicalDataType:</span>
<span class="sd">        ./{xs}complexType[@{xml}id=&#39;InstanceVariableXsdType&#39;]//{xs}element[@{xml}id=&#39;InstanceVariable-physicalDataType&#39;]</span>

<span class="sd">        Returns a dictionary with attribute cardinality information.</span>

<span class="sd">        Example:</span>
<span class="sd">        {</span>
<span class="sd">            &quot;minOccurs&quot;: &quot;0&quot;,</span>
<span class="sd">            &quot;maxOccurs&quot;: &quot;unbounded&quot;,</span>
<span class="sd">            &quot;display&quot;: &quot;0..*&quot;</span>
<span class="sd">        }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cardinality</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">attribute_name</span> <span class="o">=</span> <span class="n">attribute_uri</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Get the local name of the attribute</span>
        <span class="n">resource_name</span> <span class="o">=</span> <span class="n">attribute_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Get the local name of the resource</span>
        <span class="n">xpath</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;./</span><span class="se">{{</span><span class="si">{</span><span class="n">XMLNS</span><span class="p">[</span><span class="s1">&#39;xs&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span><span class="s2">complexType[@</span><span class="se">{{</span><span class="si">{</span><span class="n">XMLNS</span><span class="p">[</span><span class="s1">&#39;xml&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span><span class="s2">id=&#39;</span><span class="si">{</span><span class="n">resource_name</span><span class="si">}</span><span class="s2">XsdType&#39;]//</span><span class="se">{{</span><span class="si">{</span><span class="n">XMLNS</span><span class="p">[</span><span class="s1">&#39;xs&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span><span class="s2">element[@</span><span class="se">{{</span><span class="si">{</span><span class="n">XMLNS</span><span class="p">[</span><span class="s1">&#39;xml&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span><span class="s2">id=&#39;</span><span class="si">{</span><span class="n">attribute_name</span><span class="si">}</span><span class="s2">&#39;]&quot;</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">xpath</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">elements</span><span class="p">:</span>
            <span class="c1"># Assuming the first element is the one we want</span>
            <span class="n">element</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">cardinality</span><span class="p">[</span><span class="s2">&quot;minOccurs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;minOccurs&quot;</span><span class="p">)</span>
            <span class="n">cardinality</span><span class="p">[</span><span class="s2">&quot;maxOccurs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;maxOccurs&quot;</span><span class="p">)</span>
            <span class="c1"># Convert to a string representation</span>
            <span class="n">cardinality</span><span class="p">[</span><span class="s2">&quot;display&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cardinality</span><span class="p">[</span><span class="s1">&#39;minOccurs&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">..</span><span class="si">{</span><span class="n">cardinality</span><span class="p">[</span><span class="s1">&#39;maxOccurs&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="n">cardinality</span><span class="p">[</span><span class="s2">&quot;maxOccurs&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;unbounded&quot;</span>
                <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cardinality</span><span class="p">[</span><span class="s1">&#39;minOccurs&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">..*&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">cardinality</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_resource_domain_attributes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">resource_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">inherited</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves all domain attributes for a given resource URI.</span>
<span class="sd">        Returns a dictionary with attribute URIs as keys and their cardinality as values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">attributes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">attribute_uri</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_ucmis_domain_attributes</span><span class="p">(</span><span class="n">resource_uri</span><span class="p">):</span>
            <span class="n">properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_properties</span><span class="p">(</span><span class="n">attribute_uri</span><span class="p">)</span>
            <span class="nb">range</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rdfs:range&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">range</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="nb">range</span><span class="p">)</span> <span class="k">if</span> <span class="nb">range</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">cardinality</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_attribute_cardinality</span><span class="p">(</span><span class="n">resource_uri</span><span class="p">,</span> <span class="n">attribute_uri</span><span class="p">)</span>
            <span class="n">attribute</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="n">attribute_uri</span><span class="p">,</span>
                <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rdfs:label&quot;</span><span class="p">),</span>
                <span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">,</span>
                <span class="s2">&quot;cardinality&quot;</span><span class="p">:</span> <span class="n">cardinality</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="n">inherited</span><span class="p">:</span>
                <span class="n">attribute</span><span class="p">[</span><span class="s2">&quot;inherited&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
                <span class="n">attribute</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rdfs:comment&quot;</span><span class="p">)</span>
            <span class="n">attributes</span><span class="p">[</span><span class="n">attribute_uri</span><span class="p">]</span> <span class="o">=</span> <span class="n">attribute</span>
        <span class="k">if</span> <span class="n">inherited</span><span class="p">:</span>
            <span class="c1"># get attributes from superclasses</span>
            <span class="n">superclasses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_superclasses</span><span class="p">(</span><span class="n">resource_uri</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">superclass_uri</span> <span class="ow">in</span> <span class="n">superclasses</span><span class="p">:</span>
                <span class="n">superclass_attributes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_domain_attributes</span><span class="p">(</span><span class="n">superclass_uri</span><span class="p">,</span> <span class="n">inherited</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">superclass_attribute</span> <span class="ow">in</span> <span class="n">superclass_attributes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="n">superclass_attribute</span><span class="p">[</span><span class="s2">&quot;inherited&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Mark as inherited</span>
                    <span class="n">superclass_attribute</span><span class="p">[</span><span class="s2">&quot;inherited_from&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">superclass_uri</span>  <span class="c1"># Mark the superclass</span>
                    <span class="n">attributes</span><span class="p">[</span><span class="n">superclass_attribute</span><span class="p">[</span><span class="s2">&quot;uri&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">superclass_attribute</span>
        <span class="k">return</span> <span class="n">attributes</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_resource_range_attributes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">resource_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">inherited</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves all range attributes for a given resource URI.</span>
<span class="sd">        Returns a dictionary with attribute URIs as keys and their cardinality as values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">attributes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">attribute_uri</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_ucmis_range_attributes</span><span class="p">(</span><span class="n">resource_uri</span><span class="p">):</span>
            <span class="n">properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_properties</span><span class="p">(</span><span class="n">attribute_uri</span><span class="p">)</span>
            <span class="nb">range</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rdfs:range&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">range</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="nb">range</span><span class="p">)</span> <span class="k">if</span> <span class="nb">range</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">cardinality</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_attribute_cardinality</span><span class="p">(</span><span class="n">resource_uri</span><span class="p">,</span> <span class="n">attribute_uri</span><span class="p">)</span>
            <span class="n">attribute</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="n">attribute_uri</span><span class="p">,</span>
                <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rdfs:label&quot;</span><span class="p">),</span>
                <span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">,</span>
                <span class="s2">&quot;cardinality&quot;</span><span class="p">:</span> <span class="n">cardinality</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="n">inherited</span><span class="p">:</span>
                <span class="n">attribute</span><span class="p">[</span><span class="s2">&quot;inherited&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
                <span class="n">attribute</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rdfs:comment&quot;</span><span class="p">)</span>
            <span class="n">attributes</span><span class="p">[</span><span class="n">attribute_uri</span><span class="p">]</span> <span class="o">=</span> <span class="n">attribute</span>
        <span class="k">if</span> <span class="n">inherited</span><span class="p">:</span>
            <span class="c1"># get attributes from superclasses</span>
            <span class="n">superclasses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_superclasses</span><span class="p">(</span><span class="n">resource_uri</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">superclass_uri</span> <span class="ow">in</span> <span class="n">superclasses</span><span class="p">:</span>
                <span class="n">superclass_attributes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_range_attributes</span><span class="p">(</span><span class="n">superclass_uri</span><span class="p">,</span> <span class="n">inherited</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">superclass_attribute</span> <span class="ow">in</span> <span class="n">superclass_attributes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="n">superclass_attribute</span><span class="p">[</span><span class="s2">&quot;inherited&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Mark as inherited</span>
                    <span class="n">superclass_attribute</span><span class="p">[</span><span class="s2">&quot;inherited_from&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">superclass_uri</span>  <span class="c1"># Mark the superclass</span>
                    <span class="n">attributes</span><span class="p">[</span><span class="n">superclass_attribute</span><span class="p">[</span><span class="s2">&quot;uri&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">superclass_attribute</span>
        <span class="k">return</span> <span class="n">attributes</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_resource_associations</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">resource_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">include_from</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">include_to</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">inherited</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">cardinalities</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
        <span class="n">associations</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># from</span>
        <span class="k">if</span> <span class="n">include_from</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">association_uri</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_ucmis_associations_from</span><span class="p">(</span><span class="n">resource_uri</span><span class="p">):</span>
                <span class="n">association</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="n">association_uri</span><span class="p">,</span> <span class="s2">&quot;direction&quot;</span><span class="p">:</span> <span class="s2">&quot;from&quot;</span><span class="p">}</span>
                <span class="n">properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_properties</span><span class="p">(</span><span class="n">association_uri</span><span class="p">)</span>
                <span class="nb">range</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rdfs:range&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">range</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="nb">range</span><span class="p">)</span> <span class="k">if</span> <span class="nb">range</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="n">association</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rdfs:label&quot;</span><span class="p">)</span>
                <span class="n">association</span><span class="p">[</span><span class="s2">&quot;altLabel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;skos:altLabel&quot;</span><span class="p">)</span>
                <span class="n">association</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rdfs:comment&quot;</span><span class="p">)</span>
                <span class="n">association</span><span class="p">[</span><span class="s2">&quot;domain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rdfs:domain&quot;</span><span class="p">)</span>
                <span class="n">association</span><span class="p">[</span><span class="s2">&quot;range&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span>
                <span class="k">if</span> <span class="n">inherited</span><span class="p">:</span>
                    <span class="n">association</span><span class="p">[</span><span class="s2">&quot;inherited&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">cardinalities</span><span class="p">:</span>
                    <span class="n">association</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_association_cardinalities</span><span class="p">(</span><span class="n">association_uri</span><span class="p">))</span>
                <span class="n">associations</span><span class="p">[</span><span class="n">association_uri</span><span class="p">]</span> <span class="o">=</span> <span class="n">association</span>
        <span class="c1"># to</span>
        <span class="k">if</span> <span class="n">include_to</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">association_uri</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_ucmis_associations_to</span><span class="p">(</span><span class="n">resource_uri</span><span class="p">):</span>
                <span class="n">association</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="n">association_uri</span><span class="p">,</span> <span class="s2">&quot;direction&quot;</span><span class="p">:</span> <span class="s2">&quot;to&quot;</span><span class="p">}</span>
                <span class="k">if</span> <span class="n">inherited</span><span class="p">:</span>
                    <span class="n">association</span><span class="p">[</span><span class="s2">&quot;inherited&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">cardinalities</span><span class="p">:</span>
                    <span class="n">association</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_association_cardinalities</span><span class="p">(</span><span class="n">association_uri</span><span class="p">))</span>
                <span class="n">associations</span><span class="p">[</span><span class="n">association_uri</span><span class="p">]</span> <span class="o">=</span> <span class="n">association</span>
        <span class="k">if</span> <span class="n">inherited</span><span class="p">:</span>
            <span class="c1"># get attributes from superclasses</span>
            <span class="n">superclasses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_superclasses</span><span class="p">(</span><span class="n">resource_uri</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">superclass_uri</span> <span class="ow">in</span> <span class="n">superclasses</span><span class="p">:</span>
                <span class="n">superclass_associations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_associations</span><span class="p">(</span>
                    <span class="n">superclass_uri</span><span class="p">,</span> <span class="n">inherited</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cardinalities</span><span class="o">=</span><span class="n">cardinalities</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">superclass_attribute</span> <span class="ow">in</span> <span class="n">superclass_associations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="n">superclass_attribute</span><span class="p">[</span><span class="s2">&quot;inherited&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Mark as inherited</span>
                    <span class="n">superclass_attribute</span><span class="p">[</span><span class="s2">&quot;inherited_from&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">superclass_uri</span>  <span class="c1"># Mark the superclass</span>
                    <span class="n">associations</span><span class="p">[</span><span class="n">superclass_attribute</span><span class="p">[</span><span class="s2">&quot;uri&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">superclass_attribute</span>
        <span class="k">return</span> <span class="n">associations</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_resource_associations_from</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">resource_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">inherited</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">cardinalities</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves all FROM associations that have the given resource_uri as their rdfs:domain.</span>
<span class="sd">        Returns a dictionary with association URIs as keys and their properties as values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_associations</span><span class="p">(</span>
            <span class="n">resource_uri</span><span class="p">,</span> <span class="n">include_from</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_to</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inherited</span><span class="o">=</span><span class="n">inherited</span><span class="p">,</span> <span class="n">cardinalities</span><span class="o">=</span><span class="n">cardinalities</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_resource_associations_to</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">resource_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">inherited</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">cardinalities</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves all TO associations that have the given resource_uri as their rdfs:range.</span>
<span class="sd">        Returns a dictionary with association URIs as keys and their properties as values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_associations</span><span class="p">(</span>
            <span class="n">resource_uri</span><span class="p">,</span> <span class="n">include_from</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_to</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inherited</span><span class="o">=</span><span class="n">inherited</span><span class="p">,</span> <span class="n">cardinalities</span><span class="o">=</span><span class="n">cardinalities</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_resource_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves all RDF properties of a given resource URI in the graph.</span>
<span class="sd">        Returns a dictionary with property URIs as keys and their values as lists or single values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT ?property ?value</span>
<span class="s2">        WHERE </span><span class="se">{{</span>
<span class="s2">            </span><span class="si">{</span><span class="n">resource_uri</span><span class="si">}</span><span class="s2"> ?property ?value .</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="n">properties</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># Process results into a dictionary</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="n">prop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  <span class="c1"># type: ignore</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># type: ignore</span>
            <span class="k">if</span> <span class="n">prop</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">properties</span><span class="p">:</span>
                <span class="n">properties</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">properties</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="c1"># Convert lists with a single item to just the item</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">properties</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">properties</span><span class="p">[</span><span class="n">prop</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">properties</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span><span class="p">[</span><span class="n">prop</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">properties</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_resource_ucmis_associations_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves all ucmis:Association resources that have the given resource_uri as their rdfs:domain.</span>
<span class="sd">        Returns a list of association URIs (as prefixed URIs if possible).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            SELECT ?association</span>
<span class="s2">            WHERE </span><span class="se">{{</span>
<span class="s2">                ?association a ucmis:Association ;</span>
<span class="s2">                rdfs:domain </span><span class="si">{</span><span class="n">resource_uri</span><span class="si">}</span><span class="s2"> .</span>
<span class="s2">            </span><span class="se">}}</span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>  <span class="c1"># type: ignore</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_resource_ucmis_associations_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves all ucmis:Association resources that have the given resource_uri as their rdfs:range.</span>
<span class="sd">        Returns a list of association URIs (as prefixed URIs if possible).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            SELECT ?association</span>
<span class="s2">            WHERE </span><span class="se">{{</span>
<span class="s2">                ?association a ucmis:Association ;</span>
<span class="s2">                rdfs:range </span><span class="si">{</span><span class="n">resource_uri</span><span class="si">}</span><span class="s2"> .</span>
<span class="s2">            </span><span class="se">}}</span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>  <span class="c1"># type: ignore</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_resource_ucmis_domain_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves all ucmis:Attribute resources that have the given resource_uri as their rdfs:domain.</span>
<span class="sd">        Returns a list of attribute URIs (as prefixed URIs if possible).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT ?attribute</span>
<span class="s2">        WHERE </span><span class="se">{{</span>
<span class="s2">            ?attribute a ucmis:Attribute ;</span>
<span class="s2">            rdfs:domain </span><span class="si">{</span><span class="n">resource_uri</span><span class="si">}</span><span class="s2"> .</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>  <span class="c1"># type: ignore</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_resource_ucmis_range_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves all ucmis:Attribute resources that have the given resource_uri as their rdfs:range.</span>
<span class="sd">        Returns a list of attribute URIs (as prefixed URIs if possible).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT ?attribute</span>
<span class="s2">        WHERE </span><span class="se">{{</span>
<span class="s2">            ?attribute a ucmis:Attribute ;</span>
<span class="s2">            rdfs:range </span><span class="si">{</span><span class="n">resource_uri</span><span class="si">}</span><span class="s2"> .</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>  <span class="c1"># type: ignore</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_resource_superclasses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves all superclasses of a given resource URI via rdfs:subClassOf.</span>
<span class="sd">        Returns a set of superclass URIs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT DISTINCT ?superclass</span>
<span class="s2">        WHERE </span><span class="se">{{</span>
<span class="s2">            </span><span class="si">{</span><span class="n">resource_uri</span><span class="si">}</span><span class="s2"> rdfs:subClassOf* ?superclass .</span>
<span class="s2">            FILTER(?superclass != </span><span class="si">{</span><span class="n">resource_uri</span><span class="si">}</span><span class="s2">)</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_resource_subclasses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves all subclasses of a given resource URI via rdfs:subClassOf.</span>
<span class="sd">        Returns a set of subclass URIs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT DISTINCT ?subclass</span>
<span class="s2">        WHERE </span><span class="se">{{</span>
<span class="s2">            ?subclass rdfs:subClassOf* </span><span class="si">{</span><span class="n">resource_uri</span><span class="si">}</span><span class="s2"> .</span>
<span class="s2">            FILTER(?subclass != </span><span class="si">{</span><span class="n">resource_uri</span><span class="si">}</span><span class="s2">)</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_ucmis_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves all ucmis:Attribute</span>
<span class="sd">        Returns a list of attribute URIs (as prefixed URIs if possible).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT ?attribute</span>
<span class="s2">        WHERE {</span>
<span class="s2">            ?attribute a ucmis:Attribute .</span>
<span class="s2">        }</span>
<span class="s2">        order by ?attribute</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>  <span class="c1"># type: ignore</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_ucmis_associations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves all ucmis:Association</span>
<span class="sd">        Returns a list of associations URIs (as prefixed URIs if possible).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT ?association</span>
<span class="s2">        WHERE {</span>
<span class="s2">            ?association a ucmis:Association .</span>
<span class="s2">        }</span>
<span class="s2">        order by ?association</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>  <span class="c1"># type: ignore</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_ucmis_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves all ucmis:Classes</span>
<span class="sd">        Returns a list of attribute URIs (as prefixed URIs if possible).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT ?class</span>
<span class="s2">        WHERE {</span>
<span class="s2">            ?class a ucmis:Class .</span>
<span class="s2">        }</span>
<span class="s2">        order by ?class</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>  <span class="c1"># type: ignore</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_ucmis_enumerations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves all ucmis:Enumeration</span>
<span class="sd">        Returns a list of enumeration URIs (as prefixed URIs if possible).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT ?enumeration</span>
<span class="s2">        WHERE {</span>
<span class="s2">            ?enumeration a ucmis:Enumeration .</span>
<span class="s2">        }</span>
<span class="s2">        order by ?enumeration</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>  <span class="c1"># type: ignore</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_ucmis_structureddatatypes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves all ucmis:StructuredDataType</span>
<span class="sd">        Returns a list of datatype URIs (as prefixed URIs if possible).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT ?datatype</span>
<span class="s2">        WHERE {</span>
<span class="s2">            ?datatype a ucmis:StructuredDataType .</span>
<span class="s2">        }</span>
<span class="s2">        order by ?datatype</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>  <span class="c1"># type: ignore</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_subclassof</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves all rdfs:subClassOf relationships in the RDF graph.</span>
<span class="sd">        Returns a dictionary where keys are child class URIs and values are parent class URIs.</span>
<span class="sd">        The URIs are returned as prefixed URIs if possible.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT ?child ?parent</span>
<span class="s2">        WHERE {</span>
<span class="s2">                ?child rdfs:subClassOf ?parent.</span>
<span class="s2">            }</span>
<span class="s2">        order by ?child</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="n">subclass_of</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="n">child_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  <span class="c1"># type: ignore</span>
            <span class="n">parent_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>  <span class="c1"># type: ignore</span>
            <span class="n">subclass_of</span><span class="p">[</span><span class="n">child_uri</span><span class="p">]</span> <span class="o">=</span> <span class="n">parent_uri</span>
        <span class="k">return</span> <span class="n">subclass_of</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">prefixed_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts a full URI to a prefixed URI if it matches any of the known namespaces.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">ns_uri</span> <span class="ow">in</span> <span class="n">NAMESPACES</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">uri</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">ns_uri</span><span class="p">):</span>
                <span class="n">uri</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">uri</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">ns_uri</span><span class="p">)</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">uri</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">full_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts a prefixed URI to a full URI if it matches any of the known namespaces.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">ns_uri</span> <span class="ow">in</span> <span class="n">NAMESPACES</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">uri</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">):</span>
                <span class="n">uri</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ns_uri</span><span class="si">}{</span><span class="n">uri</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">uri</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">search_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Searches for classes in the RDF graph by their name.</span>
<span class="sd">        Returns a list of matching class URIs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        PREFIX ucmis: &lt;</span><span class="si">{</span><span class="n">NAMESPACES</span><span class="p">[</span><span class="s2">&quot;ucmis&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&gt;</span>
<span class="s2">        SELECT ?class</span>
<span class="s2">        WHERE </span><span class="se">{{</span>
<span class="s2">            ?class a ucmis:Class .</span>
<span class="s2">            FILTER regex(str(?class), &quot;</span><span class="si">{</span><span class="n">class_name</span><span class="si">}</span><span class="s2">&quot;, &quot;i&quot;)</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prefixed_uri</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>  <span class="c1"># type: ignore</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024-2025, Pascal L.G.A. Heus.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>